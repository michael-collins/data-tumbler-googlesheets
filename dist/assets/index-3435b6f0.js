var z=Object.defineProperty;var Q=(l,t,n)=>t in l?z(l,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):l[t]=n;var L=(l,t,n)=>(Q(l,typeof t!="symbol"?t+"":t,n),n);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const d of document.querySelectorAll('link[rel="modulepreload"]'))o(d);new MutationObserver(d=>{for(const c of d)if(c.type==="childList")for(const b of c.addedNodes)b.tagName==="LINK"&&b.rel==="modulepreload"&&o(b)}).observe(document,{childList:!0,subtree:!0});function n(d){const c={};return d.integrity&&(c.integrity=d.integrity),d.referrerPolicy&&(c.referrerPolicy=d.referrerPolicy),d.crossOrigin==="use-credentials"?c.credentials="include":d.crossOrigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function o(d){if(d.ep)return;d.ep=!0;const c=n(d);fetch(d.href,c)}})();class U extends HTMLElement{connectedCallback(){this.render()}async attributeChangedCallback(t,n,o){t==="word"&&await this.preRender(t,n,o),this.render(),t==="word"&&await this.postRender(t,n,o)}render(){const t=this.getAttribute("label"),n=t!=null&&t.trim()?"":"hidden";this.innerHTML=`
      <div class="relative overflow-visible flex items-center justify-center min-h-[80px] bg-white p-6 shadow-sm border-l-4 border-black">
        <div class="absolute -top-10 left-1/2 -translate-x-1/2 bg-black text-white px-4 py-1 rounded-full text-sm font-medium whitespace-nowrap shadow-sm z-10 max-w-[90%] overflow-hidden text-ellipsis word-label ${n}">
          ${t??""}
        </div>
        <div class="word text-center text-lg font-medium break-words hyphens-auto">
          ${this.getAttribute("word")??""}
        </div>
      </div>
    `}async preRender(t,n,o){t==="word"&&this.classList.remove("tumble")}async postRender(t,n,o){t==="word"&&this.classList.add("tumble")}}L(U,"tag","tumbler-word"),L(U,"observedAttributes",["label","word"]);customElements.define(U.tag,U);class H extends HTMLElement{connectedCallback(){this.render(),this.attachEventListeners()}attachEventListeners(){const t=this.querySelector("#sheetsUrl"),n=this.querySelector("#fetchBtn");n==null||n.addEventListener("click",()=>{const o=t==null?void 0:t.value.trim();o&&this.dispatchEvent(new CustomEvent("sheet-load",{bubbles:!0,composed:!0,detail:{url:o}}))})}render(){this.innerHTML=`
        <div class="mt-8 p-6 sheet-config">
          <input 
            type="url" 
            id="sheetsUrl" 
            class="w-full p-2 bg-white border border-gray-400 rounded-md text-base mb-4"
            placeholder="Enter Google Sheets CSV URL">
          <button 
            id="fetchBtn"
            class="bg-gray-500 text-white px-5 py-2 rounded-md text-sm flex items-center gap-2 transition-all hover:-translate-y-0.5 hover:shadow-md">
            <svg class="w-5 h-5" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-8l-4-4m0 0L8 8m4-4v12" />
            </svg>
            Load Sheet
          </button>
        </div>
      `}setLoading(t){const n=this.querySelector("#fetchBtn");n&&(n.disabled=t)}setValue(t){const n=this.querySelector("#sheetsUrl");n&&(n.value=t)}}L(H,"tag","sheet-loader");customElements.define(H.tag,H);const W=window.Papa,S="https://docs.google.com/spreadsheets/d/e/2PACX-1vS5jAMbi-ggWEDgRH3xURkCuVi2QQ_HiNPHAsq80EMMvqR0imJuaZTMSW3CdiXJtsXzAM2HQ_Hiizao/pub?gid=0&single=true&output=csv";function T(l){return function(){var t=l+=1831565813;return t=Math.imul(t^t>>>15,t|1),t^=t+Math.imul(t^t>>>7,t|61),((t^t>>>14)>>>0)/4294967296}}document.addEventListener("DOMContentLoaded",()=>{const l=document.getElementById("generateBtn"),t=document.getElementById("error"),n=document.getElementById("wordContainer"),o=document.querySelector("sheet-loader"),d=document.getElementById("iframe-hide-controls"),c=document.getElementById("iframe-hide-sheet-config"),b=document.getElementById("iframe-hide-labels"),V=document.getElementById("iframe-use-current-sheet"),O=document.getElementById("iframe-hide-embed-config"),P=document.getElementById("iframe-random"),x=document.getElementById("iframe-seed"),M=document.getElementById("iframe-output"),B=document.getElementById("copy-iframe-btn");let A=null,u=[],h=[];function q(e){t.textContent=e,t.classList.remove("hidden")}function D(){t.classList.add("hidden")}function v(){const e=new URLSearchParams(window.location.search);return{random:e.get("random")==="true",seed:parseInt(e.get("seed")),sheetUrl:e.get("sheet")||S,hideControls:e.get("hide-controls")==="true",hideSheetConfig:e.get("hide-sheet-config")==="true",hideLabels:e.get("hide-labels")==="true",hideEmbedConfig:e.get("hide-embed-config")==="true"}}function $(e,r,s){document.querySelectorAll(".controls-toggle").forEach(f=>{f.classList.contains("embed-config")&&s===!1?f.style.display="":f.style.display=e?"none":""});const i=document.querySelector(".sheet-config");i&&(i.style.display=e||r?"none":"");const a=document.querySelector(".embed-config");a&&(a.style.display=e||s?"none":"")}function I(e){var s;if(n.innerHTML="",e===0||!h||h.length===0||!v().seed){n.classList.add("hidden");return}n.classList.remove("hidden");const r=v();for(let i=0;i<e;i++){const a=document.createElement("tumbler-word");(s=h[i])!=null&&s.trim()&&!r.hideLabels&&a.setAttribute("label",h[i]),a.dataset.index=i,n.appendChild(a)}}async function k(e=!1){if(u.length===0)return;const r=v(),s=e?Math.floor(Math.random()*1e6):r.seed||Math.floor(Math.random()*1e6),i=T(s),a=new URL(window.location.href);a.searchParams.set("seed",s),r.sheetUrl!==S&&a.searchParams.set("sheet",r.sheetUrl),window.history.pushState({sheetUrl:r.sheetUrl,wordColumns:u,headers:h,seed:s},"",a),n.children.length||I(u.length),n.classList.remove("hidden"),document.querySelectorAll("tumbler-word").forEach((E,p)=>{setTimeout(()=>{const g=u[p],m=Math.floor(i()*g.length);E.setAttribute("word",g[m])},p*100)})}async function R(e){if(e===A)return l.disabled=!1,!0;try{o==null||o.setLoading(!0),l.disabled=!0;const r=await fetch(e);if(!r.ok)throw new Error(`HTTP error! status: ${r.status}`);const s=await r.text(),i=F(s);return i.success?(D(),h=i.headers,I(u.length),A=e,l.disabled=!1,!0):!1}catch(r){return console.error("Fetch error:",r),q(r.message),!1}finally{o==null||o.setLoading(!1)}}function F(e){var r;try{const s=e.replace(/^\ufeff/,"").replace(/\r\n|\r/g,`
`),a=W.parse(s,{header:!1,skipEmptyLines:"greedy",delimiter:",",quoteChar:'"',encoding:"UTF-8"}).data;if(!a||a.length===0)throw new Error("No data found in CSV");const f=a[0],E=f.length===1&&((r=f[0])==null?void 0:r.trim());h=E?Array(f.length).fill(""):f;const p=E?0:1,g=h.length;u=[];for(let m=0;m<g;m++)u[m]=[];for(let m=p;m<a.length;m++){const C=a[m];for(let y=0;y<g;y++)C[y]&&C[y].trim()&&u[y].push(C[y].trim())}return{success:!0,headers:h}}catch(s){return console.error("Process error:",s),q(s.message),{success:!1,headers:null}}}function N(){const e=window.location.origin+window.location.pathname,r=v(),s=new URLSearchParams;P.checked?s.set("random","true"):x.value?s.set("seed",x.value):r.seed&&s.set("seed",r.seed),d.checked&&s.set("hide-controls","true"),c.checked&&s.set("hide-sheet-config","true"),b.checked&&s.set("hide-labels","true"),O.checked&&s.set("hide-embed-config","true"),V.checked?r.sheetUrl&&r.sheetUrl!==S&&s.set("sheet",r.sheetUrl):s.set("sheet",S);const i=s.toString();return`${e}${i?"?"+i:""}`}function w(){const r=`<iframe src="${N()}" width="100%" height="400" frameborder="0"></iframe>`;M&&(M.value=r)}l.addEventListener("click",()=>{k(!0),w()}),document.addEventListener("sheet-load",async e=>{const r=e.detail.url;if(await R(r)){const s=new URL(window.location.href);s.searchParams.set("sheet",r),window.history.pushState({sheetUrl:r,wordColumns:u,headers:h,seed:null},"",s),k(),w()}}),window.addEventListener("popstate",e=>{if(e.state){const{sheetUrl:r,wordColumns:s,headers:i,seed:a}=e.state;if(o==null||o.setValue(r),u=s,h=i,I(u.length),a){const f=T(a);document.querySelectorAll("tumbler-word").forEach((p,g)=>{const m=u[g],C=Math.floor(f()*m.length);p.setAttribute("word",m[C])})}w()}}),document.querySelectorAll(".iframe-param").forEach(e=>{e.type==="checkbox"?e.addEventListener("change",()=>{e.id==="iframe-random"&&e.checked&&(x.value=""),w()}):e.type==="number"&&e.addEventListener("input",()=>{e.value&&(P.checked=!1),w()})}),B.addEventListener("click",()=>{M.select(),document.execCommand("copy"),B.textContent="Copied!",setTimeout(()=>{B.textContent="Copy Code"},1500)});async function _(){const e=v();o==null||o.setValue(e.sheetUrl),$(e.hideControls,e.hideSheetConfig,e.hideEmbedConfig),await R(e.sheetUrl)&&(window.history.replaceState({sheetUrl:e.sheetUrl,wordColumns:u,headers:h,seed:e.seed},"",window.location.href),(e.random||e.seed)&&k(!1)),w()}_()});
